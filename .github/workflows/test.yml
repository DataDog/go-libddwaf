name: Test
on:
  workflow_dispatch: # manually
  schedule: # nightly
    - cron: "0 0 * * *"
  pull_request: # on pull requests touching appsec files
  push: # on push to the main branch
    branches:
      - main

jobs:
  bare-metal:
    uses: ./.github/workflows/_test_bare_metal.yml
  containerized:
    uses: ./.github/workflows/_test_containerized.yml

  # A simple join target to simplify setting up branch protection settings in GH.
  done:
    name: Done
    runs-on: ubuntu-latest
    needs:
      - bare-metal
      - containerized
    steps:
      - name: Done
        run: echo "Done!"
